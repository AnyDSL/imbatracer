/* rangesearch_impala_interface.h : Impala interface file generated by impala */
#ifndef RANGESEARCH_IMPALA_INTERFACE_H
#define RANGESEARCH_IMPALA_INTERFACE_H

#ifdef __cplusplus
extern "C" {
#endif

struct RawDataInfo {
    float* begin;
    int stride;
};

struct Float3 {
    float x;
    float y;
    float z;
};

struct Buffer {
    int device;
    char* data;
};

struct PhotonHashGrid {
    float radius;
    float radius_sqr;
    float cell_size;
    float inv_cell_size;
    int photons_size;
    int indices_size;
    int cell_ends_size;
    struct Float3 bbox_min;
    struct Float3 bbox_max;
    struct RawDataInfo raw_data_info;
    int* indices;
    int* cell_ends;
    float* photons;
    int* neighbor;
    struct Buffer host_photons_buf;
    struct Buffer host_indices_buf;
    struct Buffer host_cell_ends_buf;
    struct Buffer dev_photons_buf;
    struct Buffer dev_indices_buf;
    struct Buffer dev_mask_buf;
    struct Buffer dev_pfs_buf;
};

struct QueryResult {
    int size;
    int* data;
    struct Buffer buffer;
};

struct PhotonHashGrid* build_hashgrid(struct RawDataInfo* info, int photon_cnt, int cell_size, float rad);
struct QueryResult* query_hashgrid(struct PhotonHashGrid* hg, float x, float y, float z);
void destroy_hashgrid(struct PhotonHashGrid* hg);
void release_query(struct QueryResult* arr);

#ifdef __cplusplus
}
#endif

#endif /* RANGESEARCH_IMPALA_INTERFACE_H */

